## 7장 - AmazonRDS

**Amazon RDS**는 Amazon Aurora를 비롯한 주요 관계형 데이터베이스를 제공하는 서비스이다.

### Amazon RDS란: 주요 RDBMS를 제공하는 데이터베이스 서비스

Amazon Relational Database Service(Amazon RDS)는 관계형 데이터베이스 6종류의 제품을 클라우드에 최적화된 상태로 제공하는 서비스이다.

> **Amazon Aurora, MySQL, Oracle, PostgreSQL, Maria DB, SQL Server 이다.**

데이터베이스 제공 방식은 EC2와 비슷하게 VPC상에 인스턴스로 구축하며 다양한 인스턴스를 사용할 수 있다.
- EC2와 다르게 RDS는 **매니지드 서비스**이며 업데이트 등의 관리가 AWS에 의해 자동으로 이루어진다.
- 백업이 자동화되어 있으며 AWS Database Migration Server(DMS)를 사용하면 기존 데이터베이스를 이전하거나 복제하는 것도 가능하다.

**RDS 요금 = 스토리지 요금 + 데이터베이스 인스턴스 요금 + 백업 스토리지 요금 + 통신료**

1. 스토리지 요금
   사용하고 있는 스토리지에 대한 요금이다. 확보한 용량에 대해 과금한다.
2. 데이터베이스 인스턴스 요금(DBMS 라이선스 요금 포함)
   가동한 시간당 요금이 부과된다. 이중화 여부와 인스턴스 별로 요금이 다르다. 다중 AZ로 구성해 이중화를 구축할 경우 단일 AZ 구성보다 약 2배의 요금이 부과된다.
3. 백업 스토리지 요금
   스냅샷이라고 부르는 데이터베이스 백업에 대한 요금이다. 백업 스토리지에 스냅샷을 생성하고 사용 용량에 대해 부과한다. 스냅샷 요금은 데이터베이스 스토리지 크기의 100%를 넘을 경우에만 발생한다.
4. 통신료
   인스턴스가 인터넷으로 통신할 경우 요금이 발생한다. AZ 내에서만 통신할 경우 요금은 없다.

### RDS에서 사용할 수 있는 DBMS

RDS는 AWS가 만든 **Amazon Aurora** 외에도 **PostgreSQL, MySQL, MariaDB, Oracle Database, SQL Server** 등 데이터베이스 엔진 6종류를 사용할 수 있다.

#### Amazon Aurora

**Amazon Aurora**는 MySQL이나 PostgreSQL과 호환할 수 있으며 AWS가 만든 관계형 데이터베이스이다. 요금이 비싼 편이지만 견고하고 성능이 뛰어나다.
- 호환성을 가지고 있기 때문에 온프레미스 환경의 MySQL이나 PostgreSQL을 이전할 수 있고 기존의 프로그램 및 소프트웨어를 수정할 필요도 없다.
- AWS용으로 설계되어 있기 때문에 일반적인 MySQL이나 PostgreSQL에 비해 속도가 빠르다.

### RDS 사용

![aws28.png](image%2Faws28.png)
#### 인스턴스 설정 항목

| **항목**          | **의미**                                                  |
| --------------- | ------------------------------------------------------- |
| 인스턴스 클래스        | 데이터베이스 인스턴스의 사양이다. EC2와 같이 여러 인스턴스 클래스를 제공한다.           |
| 다중 AZ 배포        | 두 개 이상의 AZ에 배포하여 이중화 구성 여부를 설정한다.                       |
| 스토리지 유형         | 스토리지의 종류이다.                                             |
| 스토리지 할당         | 스토리지의 용량이다.                                             |
| 자동 스케일링         | 스토리지가 부족할 때 자동으로 늘릴지 여부를 설정한다.                          |
| 스케일링 임계 값       | 자동 스케일링의 임계 값이다.                                        |
| 데이터베이스 클러스터 식별자 | AWS에서 데이터베이스 클러스터를 관리하기 위한 이름이다. 데이터베이스명이 아니므로 주의해야 한다. |
| 마스터 사용자명        | 데이터베이스 인스턴스의 관리자 권한을 가진 사용자명이다. 임의로 설정한다.               |
| 마스터 사용자 암호      | 데이터베이스 인스턴스의 관리자의 암호이다. 임의로 설정한다.                       |

#### 네트워크 설정 항목
| **항목**     | **의미**                                                                                                                                                 |
| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| VPC        | RDS를 설치할 VPC이다. VPC의 생성은 VPC 대시보드에서 수행한다. 기본 VPC도 선택할 수 있다.                                                                                            |
| 서브넷 그룹     | RDS를 설치할 서브넷 그룹이다. EC2 인스턴스와 연동할 경우 동일한 곳에 설치하는 것이 일반적이다.                                                                                              |
| 퍼블릭 액세스 가능 | 데이터베이스 인스턴스에 공인 IP 주소를 할당할지 여부를 나타낸다. 같은 VPC 내의 서비스가 아닌 곳에서 데이터베이스에 직접 접속할 경우(회사 내 서버에서 직접 RDS에 접속해야 하는 경우를 말하지만 보안상으로 위험하므로 실제 사용 사례는 적을 것이다)에도 필요하다. |
| 가용 영역      | RDS를 설치할 가용 영역이다. EC2 인스턴스와 연동할 경우 동일한 곳에 설치하는 것이 일반적이다(사전에 정보를 알아 두어야 한다).                                                                            |
| 보안 그룹      | 인스턴스 단위로 설정하는 방화벽이다. 사용할 포트를 열지 않으면 통신이 안 되므로 주의하자. 보안 그룹이 없으면 미리 만들어 두자. 설정하면서 생성도 가능하다.                                                              |

대부분의 RDS는 EC2에 설치된 소프트웨어와 연동해서 사용한다. 따라서 EC2와 같은 네트워크에 위치해야 하며 연동 작업이 따로 필요하다.
또한 EC2, RDS는 모두 같은 VPC에 위치해야 한다. RDS를 연동할 때 EC2와 VPC에 대한 정보를 알아두면 이 작업을 쉽게 진행할 수 있다.

### 키 밸류 데이터베이스

**키 밸류 스토어(key value store) 데이터베이스**란 데이터의 형식에 관계없이 어떤 데이터에 대해서 특정 '키'가 되는 값을 결합하여 저장하는 방식의 데이터베이스이다. 줄여서 KVS라고 표기한다.
- 관계형 데이터베이스와 다르게 유연성이 높아서 형식에 구애받지 않고 데이터를 입력할 수 있다.
- 데이터끼리 연관 관계가 없어 SQL로 고급 검색을 할 수는 없지만 RDB보다 응답 속도가 빠르다.

#### Amazon DynamoDB

**Amazon DynamoDB**는 키 밸류 스토어 데이터베이스로 VPC가 불필요해 Lambda를 사용하는 애플리케이션과 궁합이 좋다.
- 대규모 데이터를 처리하기 때문에 ACID 트랜잭션, 데이터 암호화, 접근 제한 등의 서비스를 갖추고 있다.
- 테이블을 글로벌 테이블로 생성하면 전 세계 각 리전에 분산되어 복제되며, 각 리전의 테이블에 데이터가 갱신되면 자동으로 동기화된다.

#### Amazon ElastiCache

**Amazon ElastiCache**는 인 메모리 데이터베이스이다.
- 스토리지에 저장하는 DynamoDB보다 메모리를 활용하는 ElastiCache가 더 빠르지만 인스턴스 재시작 시 데이터가 삭제된다.
- Redis용과 Memcached용이 있으며 이들과 호환하는 방식으로 사용할 수 있다.

### 그 외의 데이터베이스

#### Amazon DocumentDB(MongoDB 호환)

**Amazon DocumentDB**는 MongoDB 호환 데이터베이스 서비스로 문서 기반 데이터베이스이다.

#### Amazon Neptune

**Amazon Neptune**은 **그래프 데이터베이스**이다.
그래프 데이터란 여러 가지 요소 사이의 관계나 처리 흐름을 나타내기 때문에 노드의 방향을 포함한 노드 사이의 연결을 기록한 데이터이다.

#### Amazon Timestream

**Amazon Timestream**은 **시계열 데이터베이스** 서비스이다.
시계열 데이터베이스란 시간의 경과에 따른 사물의 변화를 기록한 데이터이다. Amazon Timestream에서는 쿼리 처리 엔진이 시간별로 처리하는데 최적화되어 있다.

#### Amazon Quantum Ledger Database

**Amazon Quantum Ledger Database(QLDB)**는 장부 데이터베이스이다.